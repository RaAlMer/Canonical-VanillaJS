{"version":3,"file":"index.js","sources":["index.js"],"sourcesContent":["function revealSection() {\n  var latestNewsSection = document.querySelector(\"[data-js='latest-news']\");\n\n  if (latestNewsSection) {\n    latestNewsSection.classList.remove(\"u-hide\");\n  }\n}\n\nfunction formatDate(date) {\n  var parsedDate = new Date(date);\n  var monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n  return parsedDate.getDate() + \" \" + monthNames[parsedDate.getMonth()] + \" \" + parsedDate.getFullYear();\n}\n\nfunction articleDiv(article, articleTemplateSelector, options) {\n  var articleFragment = getTemplate(articleTemplateSelector);\n  var time = articleFragment.querySelector(\".article-time\");\n  var link = articleFragment.querySelector(\".article-link\");\n  var title = articleFragment.querySelector(\".article-title\");\n  var image = articleFragment.querySelector(\".article-image\");\n  var author = articleFragment.querySelector(\".article-author\");\n  var excerpt = articleFragment.querySelector(\".article-excerpt\");\n  var url = \"\";\n  var imageLink = document.createElement(\"a\");\n\n  if (options.hostname) {\n    url = \"https://\" + options.hostname;\n  }\n\n  var articleImage;\n\n  if (article._embedded && article._embedded[\"wp:featuredmedia\"] && article._embedded[\"wp:featuredmedia\"][0] && article._embedded[\"wp:featuredmedia\"][0].media_details && article._embedded[\"wp:featuredmedia\"][0].media_details.width && article._embedded[\"wp:featuredmedia\"][0].media_details.height) {\n    var media = article._embedded[\"wp:featuredmedia\"][0];\n    articleImage = {\n      url: media.source_url,\n      alt: media.alt_text,\n      width: media.media_details.width,\n      height: media.media_details.height\n    };\n  }\n\n  if (author) {\n    author.innerHTML = article.author.name;\n  }\n\n  if (excerpt) {\n    excerpt.innerHTML = article.excerpt.rendered;\n  }\n\n  if (time) {\n    time.setAttribute(\"datetime\", article.date);\n    time.innerText = formatDate(article.date);\n  }\n\n  if (link) {\n    link.href = url + \"/blog/\" + article.slug;\n\n    if (options.gtmEventLabel) {\n      link.onclick = function () {\n        dataLayer.push({\n          event: \"GAEvent\",\n          eventCategory: \"blog\",\n          eventAction: options.gtmEventLabel + \" news link\",\n          eventLabel: article.slug\n        });\n      };\n    }\n  }\n\n  if (title) {\n    title.innerHTML = article.title.rendered;\n  }\n\n  if (image && articleImage && options.linkImage) {\n    imageLink.href = url + \"/blog/\" + article.slug;\n    image.appendChild(imageLink);\n  }\n\n  if (image && articleImage) {\n    var img = document.createElement(\"img\");\n    img.setAttribute(\"src\", articleImage.url);\n    img.setAttribute(\"alt\", articleImage.alt);\n    img.setAttribute(\"width\", articleImage.width);\n    img.setAttribute(\"height\", articleImage.height);\n\n    if (options.linkImage) {\n      imageLink.appendChild(img);\n    } else {\n      image.appendChild(img);\n    }\n  }\n\n  return articleFragment;\n}\n\nfunction getTemplate(selector) {\n  var template = document.querySelector(selector);\n  var fragment;\n\n  if (\"content\" in template) {\n    fragment = document.importNode(template.content, true);\n  } else {\n    fragment = document.createDocumentFragment();\n\n    for (var i = 0; i < template.childNodes.length; i++) {\n      fragment.appendChild(template.childNodes[i].cloneNode(true));\n    }\n  }\n\n  return fragment;\n}\n\nfunction latestArticlesCallback(options) {\n  return function (event) {\n    var articlesContainer = document.querySelector(options.articlesContainerSelector);\n\n    if (articlesContainer) {\n      while (articlesContainer.hasChildNodes()) {\n        articlesContainer.removeChild(articlesContainer.lastChild);\n      }\n\n      var data = JSON.parse(event.target.responseText);\n\n      if (\"spotlightContainerSelector\" in options) {\n        var spotlightContainer = document.querySelector(options.spotlightContainerSelector);\n\n        if (spotlightContainer) {\n          var latestPinned = data.latest_pinned_articles[0];\n\n          if (latestPinned) {\n            spotlightContainer.appendChild(articleDiv(latestPinned, options.spotlightTemplateSelector, options));\n          }\n        } else {\n          console.warn(\"latest-news: No spotlight container found\");\n        }\n      }\n\n      if (data.latest_articles) {\n        data.latest_articles.forEach(function (article) {\n          articlesContainer.appendChild(articleDiv(article, options.articleTemplateSelector, options));\n        });\n      }\n    } else {\n      console.warn(\"latest-news: No articles container found\");\n    }\n  };\n}\n\nfunction fetchLatestNews(options) {\n  var url = \"https://ubuntu.com/blog/latest-news\";\n  var params = [];\n  revealSection();\n\n  if (options.limit) {\n    params.push(\"limit=\" + options.limit);\n  }\n\n  if (options.tagId) {\n    params.push(\"tag-id=\" + options.tagId);\n  }\n\n  if (options.groupId) {\n    params.push(\"group-id=\" + options.groupId);\n  }\n\n  if (params.length) {\n    url += \"?\" + params.join(\"&\");\n  }\n\n  var oReq = new XMLHttpRequest();\n  oReq.addEventListener(\"load\", latestArticlesCallback(options));\n  oReq.open(\"GET\", url);\n  oReq.send();\n}\n\nif (typeof window.fetchLatestNews == \"undefined\") {\n  window.fetchLatestNews = fetchLatestNews;\n}\n\nexport { articleDiv, fetchLatestNews, formatDate, getTemplate, latestArticlesCallback, revealSection };\n//# sourceMappingURL=index.js.map\n"],"names":["latestNewsSection","document","parsedDate","monthNames","articleFragment","getTemplate","time","link","title","image","author","excerpt","url","imageLink","options","article","media","articleImage","alt","width","height","formatDate","dataLayer","event","eventCategory","eventAction","eventLabel","slug","img","template","fragment","i","articlesContainer","data","JSON","spotlightContainer","latestPinned","articleDiv","console","params","revealSection","oReq","latestArticlesCallback","window"],"mappings":"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"}